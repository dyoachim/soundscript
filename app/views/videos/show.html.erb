
<div class='videoShowContainer'>
	<div class='video_box'>
		<div id="ytapiplayer">
	  	You need Flash player 8+ and JavaScript enabled to view this video.
		</div>
	</div>
	<div class='controls_box'>
	</div>
	<div class='clearfix'></div>
	<div class="track_divs">

	<script>
	var VIDEOAPP = {
		videoId: '<%= @video.id %>',
		loggedIn: <%= current_user.present? %>
	}
	</script>

	<% if @tracks.any? %>
 			<script>
				var tracks = [],
						track = {},
						transcriptJson;
 			</script>
 		<% @tracks.each do |trackBuild| %>
 			<script>
 				transcriptJson = <%= raw trackBuild.transcript %>;
 				track.content = transcriptJson[0].content;
 				track.position_css = transcriptJson[0].position_css;
 				tracks.push(track);
 			</script>
		<% end %>
		<script>
			VIDEOAPP.tracks = tracks;
		</script>
	<% else %>
		<script>
			VIDEOAPP.tracks = null;
		</script>
	<% end %>
	</div>
</div>    
		<script type="text/javascript">
			var params = { allowScriptAccess: "always" };
			var atts = { id: "myytplayer" };
			var videoURL = "http://www.youtube.com/v/" + VIDEOAPP.videoId + "?enablejsapi=1&playerapiid=ytplayer&version=3";
			
			swfobject.embedSWF(videoURL,"ytapiplayer", "640", "321", "8", null, null, params, atts);

		  function onYouTubePlayerReady(playerId) {
		    ytplayer = document.getElementById("myytplayer");
		    VIDEOAPP.duration = ytplayer.getDuration();
		    var tracksContainer = new TracksContainer(VIDEOAPP.duration, VIDEOAPP.loggedIn, VIDEOAPP.tracks);
		  }		
		</script>
